# Syndrome Classifier

This is a machine learning project designed to classify medical syndromes based on image embeddings. The project includes data preprocessing, visualization, and classification using the K-Nearest Neighbors (KNN) algorithm. This small project was done for study purposes.

## Table of Contents
- Dataset Description
- Project Structure
- Installation
- Usage
- Results

## Dataset Description
The dataset is provided as a pickle file (`mini_gm_public_v0.1.p`) with the following structure:
- **Embeddings**: 320-dimensional vectors representing images.
- **Hierarchy**:
  ```python
  {
    'syndrome_id': {
      'subject_id': {
        'image_id': [320-dimensional embedding]
      }
    }
  }
  ```

**Goal**: Use these embeddings to classify the `syndrome_id` associated with each image.


## Project Structure
The project is structured as follows:
- `data/`: Contains the `mini_gm_public_v0.1.p` file with image embeddings.
- `stats/`: Stores statistics generated during data analysis.
- `classification.py`: Implements the KNN algorithm to classify embeddings.
- `metrics.py`: Computes evaluation metrics such as AUC, F1-Score, and Top-k Accuracy.
- `preprocessing.py`: Loads and preprocesses data from the pickle file.
- `visualization.py`: Uses t-SNE for dimensionality reduction and generates visualizations.
- `requirements.txt`: Lists the dependencies required for the project.

## Installation
To set up the project locally:
```bash
# Clone the repository
git clone https://github.com/thalissonjon/syndromeclassifier.git
cd syndromeclassifier

# Install the required dependencies
pip install -r requirements.txt
```

## Usage
Steps to run the project:
```bash
# Step 1: Data Preprocessing
# Run the preprocessing script to load and prepare the data
python preprocessing.py

# Step 2: Data Visualization
# Use the visualization script to generate a t-SNE plot of the embeddings colored by `syndrome_id`
python visualization.py

# Step 3: Classification
# Run the classification script to train and evaluate the KNN model
python classification.py

# Step 4: Metrics Calculation
# Compute evaluation metrics
python metrics.py
```

## Results

The evaluation results, generated by `metrics.py`, include:

1. **ROC AUC Curves**: A comparison of the AUC scores for Cosine and Euclidean distance metrics across different values of `k` (number of neighbors). The curves help identify the optimal `k` for each metric. The plot is saved as `roc_auc.png`.

2. **Best Results per Metric**: A table summarizing the highest Accuracy, F1-Score, and AUC achieved for each distance metric, along with the corresponding `k` values.

3. **Best Overall Results**: A summary of the best Accuracy, F1-Score, and AUC across all metrics, showing the corresponding metric type and `k` values.

4. **Average Results**: A table displaying the average Accuracy, F1-Score, and AUC for each distance metric, providing insights into the overall performance trends.

These results allow for a clear comparison of the performance of Cosine and Euclidean metrics, enabling informed decisions on the optimal configuration for KNN.

